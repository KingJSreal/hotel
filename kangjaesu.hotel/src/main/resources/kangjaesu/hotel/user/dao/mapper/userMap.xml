<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kangjaesu.hotel.user.dao.mapper.UserMapper">
	<resultMap type="user" id="userMap">
		<id property="userNum" column="user_num"/>
		<result property="userEmail" column="user_email"/>
		<result property="userPassword" column="user_pwd"/>
		<result property="userName" column="user_korname"/>
		<result property="userEngFirstName" column="user_firstname"/>
		<result property="userEngLastName" column="user_lastname"/>
		<result property="userBirth" column="user_birth"/>
		<result property="userPhone" column="user_phone"/>
		<result property="userTel" column="tel"/>
		<result property="userZip" column="zip"/>
		<result property="userAdd" column="address"/>
		<result property="userAddDetail" column="add_detail"/>
		<result property="userRegDate" column="user_reg_date"/>
		<result property="userGrade" column="grade"/>
	</resultMap>
	
	<select id="loginUser" parameterType="user" resultMap="userMap">
		select *
		from users
		<where>
			<if test="userEmail != null">
				user_email=#{userEmail}
			</if>
			<if test="userPassword != null">
				and user_pwd=#{userPassword}
			</if>
		</where>
	</select>
	
	<select id="findId" parameterType="user" resultMap="userMap">
		select user_email
		from users
		where
			user_korname = #{userName}
			and user_firstname = #{userEngFirstName}
			and user_lastname = #{userEngLastName}
			and user_birth = #{userBirth}
	</select>
	
	<select id="findPw" parameterType="user" resultMap="userMap">
		select user_pwd
		from users
		where
			user_korname = #{userName}
			and user_firstname = #{userEngFirstName}
			and user_lastname = #{userEngLastName}
			and user_birth = #{userBirth}
			and user_email = #{userEmail}
			and user_phone = #{userPhone}
	</select>
	
	<select id="getUsers" resultMap="userMap">
		select *
		from users
		order by user_num
	</select>
	
	<select id="searchUser" resultMap="userMap">
		select *
		from users
		where 
		<if test="userName != null">
			user_korname = #{userName}
		</if>
		<if test="userEmail != null">
			or user_email = #{userEmail}
		</if>
		<if test="userNum != null">
			or user_num = #{userNum}
		</if>
	</select>
	
	<select id="getUser" parameterType="user" resultMap="userMap">
		select *
		from users
		where user_num = #{userNum}
	</select>
	
	<insert id="addUser" parameterType="user">
		INSERT INTO users
			(user_num, user_email, user_pwd, user_korname,
			 user_firstname, user_lastname, user_birth, user_phone, 
			 tel, zip, address,  add_detail, user_reg_date, grade) 
		VALUES
			(User_Seq.NEXTVAL,  #{userEmail}, #{userPassword}, #{userName},
			#{userEngFirstName}, #{userEngLastName}, #{userBirth}, #{userPhone}, 
			#{userTel}, #{userZip}, #{userAdd}, #{userAddDetail}, SYSDATE, 1)
	</insert>
	<!-- 
	<update id="updateUser" parameterType="user">
		update users 
		set user_name=#{userName}, reg_date=SYSDATE
		where user_no=#{userNo}
	</update>
	
	<delete id="delUser" parameterType="int">
		delete from users 
		where user_no=#{userNo}
	</delete> 
	-->
</mapper>